{% extends 'analytics/base.html' %}

{% load static %}

{% block title %}Analytics Dashboard - Chalkstone Council{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'analytics/style.css' %}">
{% endblock %}

{% block content %}
<header class="dashboard-header">
    <h1>Analytics Dashboard</h1>
    <p>Welcome to the analytics section of Chalkstone Council. Explore various aspects of the issues reported below.</p>
</header>

<main class="dashboard-grid">
    <!-- Grid 1: Current Issue Statistics -->
    <section class="dashboard-section" id="grid1">
        <h2>Issue Statistics</h2>
        <div class="stats">
            <div class="stat-item">
                <h3>Open</h3>
                <p>{{ open_issues_count }}</p>
            </div>
            <div class="stat-item">
                <h3>In Progress</h3>
                <p>{{ in_progress_issues_count }}</p>
            </div>
            <div class="stat-item">
                <h3>Closed</h3>
                <p>{{ closed_issues_count }}</p>
            </div>
        </div>
    </section>

    <!-- Grid 2: Issue Resolution Time -->
    <section class="dashboard-section" id="grid2">
        <h2>Issue Resolution Time</h2>
        <p class="resolution-info">
            Average time to resolve issues: <strong>{{ avg_resolution_time }}</strong>
        </p>
    </section>

    <!-- Grid 3: Issues by Category -->
    <section class="dashboard-section" id="grid3">
        <h2>Issues by Category</h2>
        <table class="category-table">
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Issue Count</th>
                </tr>
            </thead>
            <tbody>
                {% for item in issues_by_category %}
                    <tr>
                        <td>{{ item.category }}</td>
                        <td>{{ item.issue_count }}</td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="2">No data available.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>

    <!-- Grid 4: Explore Analytics -->
    <section class="dashboard-section" id="grid4">
        <h2>Explore Analytics</h2>
        <ul class="analytics-links">
            <li><a href="{% url 'analytics_filter' %}" class="button">Filter and Query Issues</a></li>
            <li><a href="{% url 'analytics_charts' %}" class="button">Visualise Issues with Charts</a></li>
        </ul>
    </section>
</main>
{% endblock %}
